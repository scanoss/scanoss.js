import { expect } from 'chai';
import { ILocalDependency, ParserFuncType } from '../DependencyTypes';
import pyProjectToml from './python/PyProjectToml';
import { pomParser } from './mavenParser';


interface ParserSpecI {
  test_name: string;
  source: string;
  note: string;
  file_name: string;
  file_content: string;
  expect: ILocalDependency;
  parser: ParserFuncType;
}



const ParserSpec: ParserSpecI[] = [
  /****************************************************************************/
  /*                    POM:XML DEPENDENCY TEST DATA                          */
  /****************************************************************************/
  {
    test_name: "pom.xml example 1",
    source: "",
    note: "",
    file_name: "pom.xml",
    file_content: "<?xml version='1.0' encoding='UTF-8'?>\n<!--\n~ Copyright 2016 Red Hat, Inc. and/or its affiliates\n~ and other contributors as indicated by the @author tags.\n~\n~ Licensed under the Apache License, Version 2.0 (the \"License\");\n~ you may not use this file except in compliance with the License.\n~ You may obtain a copy of the License at\n~\n~ http://www.apache.org/licenses/LICENSE-2.0\n~\n~ Unless required by applicable law or agreed to in writing, software\n~ distributed under the License is distributed on an \"AS IS\" BASIS,\n~ WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n~ See the License for the specific language governing permissions and\n~ limitations under the License.\n\n-->\n<project xmlns=\"http://maven.apache.org/POM/4.0.0\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xsi:schemaLocation=\"http://maven.apache.org/POM/4.0.0 http://maven.apache.org/maven-v4_0_0.xsd\">\n    <modelVersion>4.0.0</modelVersion>\n\n    <parent>\n        <groupId>org.jboss</groupId>\n        <artifactId>jboss-parent</artifactId>\n        <version>37</version>\n    </parent>\n\n    <name>Keycloak</name>\n    <description>\n        Keycloak SSO\n    </description>\n    <groupId>org.keycloak</groupId>\n    <artifactId>keycloak-parent</artifactId>\n    <version>999-SNAPSHOT</version>\n    <packaging>pom</packaging>\n\n    <properties>\n        <jboss.repo.nexusUrl>https://s01.oss.sonatype.org/</jboss.repo.nexusUrl>\n        <jboss.releases.repo.id>jboss-releases-repository</jboss.releases.repo.id>\n        <jboss.releases.repo.url>https://s01.oss.sonatype.org/service/local/staging/deploy/maven2/</jboss.releases.repo.url>\n        <jboss.snapshots.repo.id>jboss-snapshots-repository</jboss.snapshots.repo.id>\n        <jboss.snapshots.repo.url>https://s01.oss.sonatype.org/content/repositories/snapshots/</jboss.snapshots.repo.url>\n\n        <quarkus.version>2.7.5.Final</quarkus.version>\n\n        <!--\n        Performing a Wildfly upgrade? Run the:\n\n             \"./misc/scripts/upgrade-wildfly/upgrade-keycloak-to-wildfly-tag.py\"\n\n        script with the corresponding Wildfly tag, e.g. '20.0.0.Final' to get necessary Keycloak bits\n        updated automatically based on corresponding artifact versions used in Wildfly and Wildfly Core\n\n        IMPORTANT: If you add new dependency name / version property below, be sure to update the\n        \"./misc/scripts/upgrade-wildfly/upgrade-keycloak-to-wildfly-tag.py\" script too to ensure\n        the script continues to work\n        -->\n\n        <product.rhsso.version>7.5.0.GA</product.rhsso.version>\n\n        <product.build-time>${timestamp}</product.build-time>\n        <wildfly.version>26.1.0.Final</wildfly.version>\n        <wildfly.build-tools.version>1.2.13.Final</wildfly.build-tools.version>\n        <eap.version>7.4.0.GA-redhat-00005</eap.version>\n        <wildfly.core.version>18.1.0.Final</wildfly.core.version>\n\n        <jboss.as.version>7.2.0.Final</jboss.as.version>\n        <jboss.as.subsystem.test.version>7.5.22.Final-redhat-1</jboss.as.subsystem.test.version>\n\n        <!-- Versions used mostly for Undertow server, aligned with WildFly -->\n        <jboss.aesh.version>0.66.19</jboss.aesh.version>\n        <aesh.version>2.4</aesh.version>\n        <apache.httpcomponents.version>4.5.13</apache.httpcomponents.version>\n        <apache.httpcomponents.httpcore.version>4.4.14</apache.httpcomponents.httpcore.version>\n        <apache.mime4j.version>0.6</apache.mime4j.version>\n        <jboss.dmr.version>1.5.1.Final</jboss.dmr.version>\n        <bouncycastle.version>1.68</bouncycastle.version>\n        <cxf.version>3.3.10</cxf.version>\n        <cxf.jetty.version>3.3.10</cxf.jetty.version>\n        <cxf.jaxrs.version>3.3.10</cxf.jaxrs.version>\n        <cxf.undertow.version>3.3.10</cxf.undertow.version>\n        <dom4j.version>2.1.3</dom4j.version>\n        <h2.version>1.4.197</h2.version>\n        <jakarta.persistence.version>2.2.3</jakarta.persistence.version>\n        <hibernate.core.version>5.3.24.Final</hibernate.core.version>\n        <hibernate.c3p0.version>5.3.24.Final</hibernate.c3p0.version>\n        <infinispan.version>12.1.7.Final</infinispan.version>\n        <infinispan.protostream.processor.version>4.4.1.Final</infinispan.protostream.processor.version>\n        <javax.annotation-api.version>1.3.2</javax.annotation-api.version>\n        <jackson.version>2.12.1</jackson.version>\n        <jackson.databind.version>2.12.6.1</jackson.databind.version>\n        <jackson.annotations.version>${jackson.databind.version}</jackson.annotations.version>\n        <jakarta.mail.version>1.6.5</jakarta.mail.version>\n        <jboss-jaxrs-api_2.1_spec>2.0.1.Final</jboss-jaxrs-api_2.1_spec>\n        <jboss.logging.version>3.4.1.Final</jboss.logging.version>\n        <jboss.logging.tools.version>2.2.1.Final</jboss.logging.tools.version>\n        <jboss.marshalling.version>2.0.11.Final</jboss.marshalling.version>\n        <jboss-transaction-api_1.3_spec>2.0.0.Final</jboss-transaction-api_1.3_spec>\n        <jboss.spec.javax.xml.bind.jboss-jaxb-api_2.3_spec.version>2.0.1.Final</jboss.spec.javax.xml.bind.jboss-jaxb-api_2.3_spec.version>\n        <jboss.spec.javax.servlet.jsp.jboss-jsp-api_2.3_spec.version>2.0.0.Final</jboss.spec.javax.servlet.jsp.jboss-jsp-api_2.3_spec.version>\n        <log4j.version>1.2.17</log4j.version>\n        <resteasy.version>3.15.1.Final</resteasy.version>\n        <resteasy.undertow.version>${resteasy.version}</resteasy.undertow.version>\n        <owasp.html.sanitizer.version>20211018.2</owasp.html.sanitizer.version>\n        <slf4j-api.version>1.7.30</slf4j-api.version>\n        <slf4j.version>1.7.30</slf4j.version>\n        <sun.istack.version>3.0.10</sun.istack.version>\n        <sun.xml.bind.version>2.3.3-b02</sun.xml.bind.version>\n        <javax.xml.bind.jaxb.version>2.4.0-b180830.0359</javax.xml.bind.jaxb.version>\n        <sun.xml.ws.version>2.3.1</sun.xml.ws.version>\n        <sun.activation.version>1.2.2</sun.activation.version>\n        <org.glassfish.jaxb.xsom.version>2.3.3-b02</org.glassfish.jaxb.xsom.version>\n        <undertow.version>2.2.5.Final</undertow.version>\n        <elytron.version>1.18.3.Final</elytron.version>\n        <elytron.undertow-server.version>1.9.0.Final</elytron.undertow-server.version>\n        <jetty94.version>9.4.40.v20210413</jetty94.version>\n        <woodstox.version>6.0.3</woodstox.version>\n        <xmlsec.version>2.2.3</xmlsec.version>\n        <glassfish.json.version>1.1.6</glassfish.json.version>\n        <wildfly.common.version>1.6.0.Final</wildfly.common.version>\n        <ua-parser.version>1.5.2</ua-parser.version>\n        <picketbox.version>5.0.3.Final</picketbox.version>\n        <google.guava.version>30.1-jre</google.guava.version>\n\n        <!-- Openshift -->\n        <version.com.openshift.openshift-restclient-java>8.0.0.Final</version.com.openshift.openshift-restclient-java>\n\n        <!-- Others -->\n        <commons-lang.version>2.6</commons-lang.version>\n        <commons-lang3.version>3.11</commons-lang3.version>\n        <commons-io.version>2.7</commons-io.version>\n        <apacheds.version>2.0.0.AM26</apacheds.version>\n        <apacheds.codec.version>2.0.0</apacheds.codec.version>\n        <google.zxing.version>3.4.0</google.zxing.version>\n        <freemarker.version>2.3.31</freemarker.version>\n\n        <jetty9.version>${jetty94.version}</jetty9.version>\n        <liquibase.version>4.8.0</liquibase.version>\n        <osgi.version>4.2.0</osgi.version>\n        <pax.web.version>7.1.0</pax.web.version>\n        <servlet.api.30.version>1.0.2.Final</servlet.api.30.version>\n        <servlet.api.40.version>2.0.0.Final</servlet.api.40.version>\n        <twitter4j.version>4.0.7</twitter4j.version>\n        <jna.version>4.1.0</jna.version>\n\n        <!-- Databases -->\n        <mysql.version>8.0.23</mysql.version>\n        <mysql.driver.version>8.0.23</mysql.driver.version>\n        <postgresql.version>13.2</postgresql.version>\n        <postgresql.driver.version>42.3.3</postgresql.driver.version>\n        <mariadb.version>10.3.27</mariadb.version>\n        <mariadb.driver.version>2.7.2</mariadb.driver.version>\n        <mssql.version>2019-CU10-ubuntu-20.04</mssql.version>\n        <mssql.driver.version>9.2.0.jre8</mssql.driver.version>\n\n        <!-- Test -->\n        <greenmail.version>1.3.1b</greenmail.version>\n        <hamcrest.version>2.2</hamcrest.version>\n        <jmeter.version>2.10</jmeter.version>\n        <junit.version>4.13.2</junit.version>\n        <picketlink.version>2.7.0.Final</picketlink.version>\n        <selenium.version>2.35.0</selenium.version>\n        <xml-apis.version>1.4.01</xml-apis.version>\n        <subethasmtp.version>3.1.7</subethasmtp.version>\n        <awaitility.version>4.1.1</awaitility.version>\n        <assertj-core.version>3.22.0</assertj-core.version>\n        <!-- KEYCLOAK-17585 Prevent microprofile-metrics-api upgrades from version \"2.3\" due to:\n             https://issues.redhat.com/browse/KEYCLOAK-17585?focusedCommentId=16002705&page=com.atlassian.jira.plugin.system.issuetabpanels%3Acomment-tabpanel#comment-16002705\n        -->\n        <microprofile-metrics-api.version>2.3</microprofile-metrics-api.version>\n\n        <!-- Maven Plugins -->\n        <replacer.plugin.version>1.3.5</replacer.plugin.version>\n        <jboss.as.plugin.version>7.5.Final</jboss.as.plugin.version>\n        <jmeter.plugin.version>1.9.0</jmeter.plugin.version>\n        <jmeter.analysis.plugin.version>1.0.4</jmeter.analysis.plugin.version>\n        <minify.plugin.version>1.7.6</minify.plugin.version>\n        <osgi.bundle.plugin.version>2.3.7</osgi.bundle.plugin.version>\n        <wildfly.plugin.version>2.0.1.Final</wildfly.plugin.version>\n        <nexus.staging.plugin.version>1.6.5</nexus.staging.plugin.version>\n        <frontend.plugin.version>1.12.0</frontend.plugin.version>\n        <docker.maven.plugin.version>0.28.0</docker.maven.plugin.version>\n        <verifier.plugin.version>1.1</verifier.plugin.version>\n\n        <!-- Surefire Settings -->\n        <surefire.memory.Xms>512m</surefire.memory.Xms>\n        <surefire.memory.Xmx>2048m</surefire.memory.Xmx>\n        <surefire.memory.metaspace>96m</surefire.memory.metaspace>\n        <surefire.memory.metaspace.max>512m</surefire.memory.metaspace.max>\n        <surefire.memory.settings>-Xms${surefire.memory.Xms} -Xmx${surefire.memory.Xmx} -XX:MetaspaceSize=${surefire.memory.metaspace} -XX:MaxMetaspaceSize=${surefire.memory.metaspace.max}</surefire.memory.settings>\n        <surefire.system.args></surefire.system.args>\n\n        <!-- Tomcat versions -->\n        <tomcat8.version>8.5.38</tomcat8.version>\n        <tomcat9.version>9.0.16</tomcat9.version>\n\n        <!-- Spring Boot versions, used for tests -->\n        <spring-boot24.version>2.4.13</spring-boot24.version>\n        <spring-boot26.version>2.6.1</spring-boot26.version>\n\n        <!-- webauthn support -->\n        <webauthn4j.version>0.12.0.RELEASE</webauthn4j.version>\n        <org.apache.kerby.kerby-asn1.version>2.0.0</org.apache.kerby.kerby-asn1.version>\n\n        <!-- WildFly Galleon Build related properties -->\n        <org.wildfly.galleon-plugins.version>5.2.7.Final</org.wildfly.galleon-plugins.version>\n        <org.jboss.galleon.version>4.2.8.Final</org.jboss.galleon.version>\n\n        <!-- Galleon -->\n        <galleon.fork.embedded>true</galleon.fork.embedded>\n        <galleon.log.time>true</galleon.log.time>\n        <galleon.offline>true</galleon.offline>\n\n        <!-- Properties that drive the names of various directories produced by and used in the build -->\n        <server.output.dir.prefix>keycloak</server.output.dir.prefix>\n        <!-- Version suffix that is appended to directories. Default is the maven GAV version but this can be edited to use a short form version -->\n        <server.output.dir.version>${project.version}</server.output.dir.version>\n\n        <!-- Frontend -->\n        <node.version>v16.13.2</node.version>\n    </properties>\n\n    <url>http://keycloak.org</url>\n\n    <licenses>\n        <license>\n            <name>Apache License, Version 2.0</name>\n            <url>https://www.apache.org/licenses/LICENSE-2.0</url>\n            <distribution>repo</distribution>\n        </license>\n    </licenses>\n\n    <scm>\n        <connection>scm:git:git://github.com/keycloak/keycloak.git</connection>\n        <developerConnection>scm:git:git@github.com:keycloak/keycloak.git</developerConnection>\n        <url>https://github.com/keycloak/keycloak/tree/master/</url>\n    </scm>\n\n    <distributionManagement>\n        <repository>\n            <id>${jboss.releases.repo.id}</id>\n            <name>JBoss Releases Repository</name>\n            <url>${jboss.releases.repo.url}</url>\n        </repository>\n    </distributionManagement>\n\n    <issueManagement>\n        <system>JIRA</system>\n        <url>https://github.com/keycloak/keycloak/issues</url>\n    </issueManagement>\n\n    <developers>\n        <developer>\n            <id>keycloak</id>\n            <name>Keycloak Team</name>\n        </developer>\n    </developers>\n\n    <contributors></contributors>\n\n    <modules>\n        <module>boms</module>\n        <module>common</module>\n        <module>core</module>\n        <module>dependencies</module>\n        <module>docs</module>\n        <module>server-spi</module>\n        <module>server-spi-private</module>\n        <module>saml-core-api</module>\n        <module>saml-core</module>\n        <module>federation</module>\n        <module>services</module>\n        <module>themes</module>\n        <module>model</module>\n        <module>util</module>\n        <module>wildfly</module>\n        <module>integration</module>\n        <module>adapters</module>\n        <module>authz</module>\n        <module>misc</module>\n    </modules>\n\n    <dependencyManagement>\n\n        <dependencies>\n\n            <dependency>\n                <groupId>org.keycloak</groupId>\n                <artifactId>keycloak-dependencies-admin-ui-wrapper</artifactId>\n                <version>${project.version}</version>\n                <type>pom</type>\n            </dependency>\n            <dependency>\n                <groupId>org.jboss</groupId>\n                <artifactId>jboss-dmr</artifactId>\n                <version>${jboss.dmr.version}</version>\n            </dependency>\n            <dependency>\n                <groupId>com.sun.istack</groupId>\n                <artifactId>istack-commons-runtime</artifactId>\n                <version>${sun.istack.version}</version>\n            </dependency>\n            <dependency>\n                <groupId>org.wildfly.common</groupId>\n                <artifactId>wildfly-common</artifactId>\n                <version>${wildfly.common.version}</version>\n            </dependency>\n\n            <!-- Authorization -->\n            <dependency>\n                <groupId>org.keycloak</groupId>\n                <artifactId>keycloak-testsuite-utils</artifactId>\n                <version>${project.version}</version>\n            </dependency>\n            <dependency>\n                <groupId>org.keycloak</groupId>\n                <artifactId>keycloak-testsuite-tools</artifactId>\n                <version>${project.version}</version>\n            </dependency>\n            <dependency>\n                <groupId>org.keycloak</groupId>\n                <artifactId>keycloak-testsuite-tools</artifactId>\n                <version>${project.version}</version>\n                <classifier>classes</classifier>\n            </dependency>\n\n            <dependency>\n                <groupId>org.eclipse.microprofile.metrics</groupId>\n                <artifactId>microprofile-metrics-api</artifactId>\n                <version>${microprofile-metrics-api.version}</version>\n                <exclusions>\n                    <exclusion>\n                        <groupId>org.osgi</groupId>\n                        <artifactId>org.osgi.annotation.versioning</artifactId>\n                    </exclusion>\n                </exclusions>\n            </dependency>\n\n            <!-- used in server-dist build while provisioning the distribution -->\n            <dependency>\n                <groupId>org.keycloak</groupId>\n                <artifactId>keycloak-server-galleon-pack</artifactId>\n                <version>${project.version}</version>\n                <type>zip</type>\n            </dependency>\n\n            <dependency>\n                <groupId>org.keycloak</groupId>\n                <artifactId>keycloak-server-galleon-pack</artifactId>\n                <version>${project.version}</version>\n                <type>pom</type>\n            </dependency>\n\n            <!-- WildFly Galleon Plugins -->\n            <dependency>\n                <groupId>org.wildfly.galleon-plugins</groupId>\n                <artifactId>wildfly-galleon-plugins</artifactId>\n                <version>${org.wildfly.galleon-plugins.version}</version>\n                <exclusions>\n                    <exclusion>\n                        <groupId>org.jboss.galleon</groupId>\n                        <artifactId>*</artifactId>\n                    </exclusion>\n                </exclusions>\n            </dependency>\n\n            <dependency>\n                <groupId>org.wildfly.galleon-plugins</groupId>\n                <artifactId>wildfly-config-gen</artifactId>\n                <version>${org.wildfly.galleon-plugins.version}</version>\n                <exclusions>\n                    <exclusion>\n                        <groupId>*</groupId>\n                        <artifactId>*</artifactId>\n                    </exclusion>\n                </exclusions>\n            </dependency>\n\n            <dependency>\n                <groupId>org.wildfly.galleon-plugins</groupId>\n                <artifactId>transformer</artifactId>\n                <version>${org.wildfly.galleon-plugins.version}</version>\n                <exclusions>\n                    <exclusion>\n                        <groupId>*</groupId>\n                        <artifactId>*</artifactId>\n                    </exclusion>\n                </exclusions>\n            </dependency>\n\n        </dependencies>\n    </dependencyManagement>\n\n    <build>\n        <pluginManagement>\n            <plugins>\n                <plugin>\n                    <groupId>org.sonatype.plugins</groupId>\n                    <artifactId>nexus-staging-maven-plugin</artifactId>\n                    <version>${nexus.staging.plugin.version}</version>\n                    <extensions>true</extensions>\n                    <configuration>\n                        <serverId>${jboss.releases.repo.id}</serverId>\n                        <nexusUrl>${jboss.repo.nexusUrl}</nexusUrl>\n                    </configuration>\n                </plugin>\n                <plugin>\n                    <groupId>org.apache.maven.plugins</groupId>\n                    <artifactId>maven-assembly-plugin</artifactId>\n                    <configuration>\n                        <tarLongFileMode>posix</tarLongFileMode>\n                    </configuration>\n                </plugin>\n                <plugin>\n                    <groupId>org.apache.maven.plugins</groupId>\n                    <artifactId>maven-dependency-plugin</artifactId>\n                    <version>3.1.2</version>\n                </plugin>\n                <plugin>\n                    <groupId>org.apache.maven.plugins</groupId>\n                    <artifactId>maven-release-plugin</artifactId>\n                    <version>2.5.2</version>\n                    <configuration>\n                        <autoVersionSubmodules>true</autoVersionSubmodules>\n                        <tagNameFormat>@{project.version}</tagNameFormat>\n                    </configuration>\n                </plugin>\n                <plugin>\n                    <groupId>org.apache.maven.plugins</groupId>\n                    <artifactId>maven-surefire-plugin</artifactId>\n                    <version>3.0.0-M5</version>\n                    <configuration>\n                        <forkNode implementation=\"org.apache.maven.plugin.surefire.extensions.SurefireForkNodeFactory\"/>\n                        <forkMode>once</forkMode>\n                        <argLine>-Djava.awt.headless=true ${surefire.memory.settings} ${surefire.system.args} -Duser.language=en -Duser.region=US</argLine>\n                        <runOrder>alphabetical</runOrder>\n                    </configuration>\n                </plugin>\n                <plugin>\n                    <groupId>org.apache.maven.plugins</groupId>\n                    <artifactId>maven-jar-plugin</artifactId>\n                </plugin>\n                <plugin>\n                    <groupId>com.google.code.maven-replacer-plugin</groupId>\n                    <artifactId>maven-replacer-plugin</artifactId>\n                    <version>${replacer.plugin.version}</version>\n                </plugin>\n                <plugin>\n                    <groupId>org.apache.maven.plugins</groupId>\n                    <artifactId>maven-install-plugin</artifactId>\n                    <configuration>\n                        <createChecksum>true</createChecksum>\n                    </configuration>\n                </plugin>\n                <plugin>\n                    <groupId>com.lazerycode.jmeter</groupId>\n                    <artifactId>jmeter-maven-plugin</artifactId>\n                    <version>${jmeter.plugin.version}</version>\n                </plugin>\n                <plugin>\n                    <groupId>com.lazerycode.jmeter</groupId>\n                    <artifactId>jmeter-analysis-maven-plugin</artifactId>\n                    <version>${jmeter.analysis.plugin.version}</version>\n                </plugin>\n                <plugin>\n                    <groupId>org.jboss.as.plugins</groupId>\n                    <artifactId>jboss-as-maven-plugin</artifactId>\n                    <version>${jboss.as.plugin.version}</version>\n                    <configuration>\n                        <skip>true</skip>\n                    </configuration>\n                </plugin>\n                <plugin>\n                    <groupId>org.wildfly.plugins</groupId>\n                    <artifactId>wildfly-maven-plugin</artifactId>\n                    <version>${wildfly.plugin.version}</version>\n                    <configuration>\n                        <skip>true</skip>\n                    </configuration>\n                </plugin>\n                <plugin>\n                    <groupId>org.jboss.galleon</groupId>\n                    <artifactId>galleon-maven-plugin</artifactId>\n                    <version>${org.jboss.galleon.version}</version>\n                </plugin>\n                <plugin>\n                    <groupId>com.samaxes.maven</groupId>\n                    <artifactId>minify-maven-plugin</artifactId>\n                    <version>${minify.plugin.version}</version>\n                </plugin>\n                <plugin>\n                    <groupId>org.liquibase</groupId>\n                    <artifactId>liquibase-maven-plugin</artifactId>\n                    <version>${liquibase.version}</version>\n                </plugin>\n                <plugin>\n                    <groupId>org.wildfly.build</groupId>\n                    <artifactId>wildfly-server-provisioning-maven-plugin</artifactId>\n                    <version>${wildfly.build-tools.version}</version>\n                </plugin>\n                <plugin>\n                    <groupId>org.wildfly.galleon-plugins</groupId>\n                    <artifactId>wildfly-galleon-maven-plugin</artifactId>\n                    <version>${org.wildfly.galleon-plugins.version}</version>\n                    <dependencies>\n                        <dependency>\n                            <groupId>org.wildfly.core</groupId>\n                            <artifactId>wildfly-embedded</artifactId>\n                            <version>${wildfly.core.version}</version>\n                        </dependency>\n                        <!-- If you add a dependency on wildfly-embedded you need to bring your own transitives -->\n                        <dependency>\n                            <groupId>org.wildfly.common</groupId>\n                            <artifactId>wildfly-common</artifactId>\n                            <version>${wildfly.common.version}</version>\n                        </dependency>\n                    </dependencies>\n                </plugin>\n                <plugin>\n                    <groupId>org.apache.maven.plugins</groupId>\n                    <artifactId>maven-verifier-plugin</artifactId>\n                    <version>${verifier.plugin.version}</version>\n                    <executions>\n                        <execution>\n                            <id>main</id>\n                            <phase>verify</phase>\n                            <goals>\n                                <goal>verify</goal>\n                            </goals>\n                        </execution>\n                    </executions>\n                    <configuration>\n                        <verificationFile>target/verifier/verifications.xml</verificationFile>\n                    </configuration>\n                </plugin>\n                <plugin>\n                    <groupId>org.apache.felix</groupId>\n                    <artifactId>maven-bundle-plugin</artifactId>\n                    <version>${osgi.bundle.plugin.version}</version>\n                </plugin>\n                <plugin>\n                    <groupId>com.github.eirslett</groupId>\n                    <artifactId>frontend-maven-plugin</artifactId>\n                    <version>${frontend.plugin.version}</version>\n                </plugin>\n                <plugin>\n                    <groupId>org.keycloak</groupId>\n                    <artifactId>keycloak-distribution-licenses-maven-plugin</artifactId>\n                    <version>${project.version}</version>\n                    <executions>\n                        <execution>\n                            <id>process-licenses</id>\n                            <goals>\n                                <goal>process</goal>\n                            </goals>\n                            <phase>process-resources</phase>\n                        </execution>\n                    </executions>\n                </plugin>\n            </plugins>\n        </pluginManagement>\n    </build>\n\n    <profiles>\n        <profile>\n            <id>community</id>\n            <activation>\n                <property>\n                    <name>!product</name>\n                </property>\n            </activation>\n            <properties>\n                <product.name>Keycloak</product.name>\n                <product.name.full>Keycloak</product.name.full>\n                <product.slot>keycloak</product.slot>\n                <product.wildfly.console.slot>main</product.wildfly.console.slot>\n                <product.name-html>\u003Cdiv class=\"kc-logo-text\"\u003E\u003Cspan\u003EKeycloak\u003C\u002Fspan\u003E\u003C\u002Fdiv\u003E</product.name-html>\n                <product.version>${project.version}</product.version>\n                <product.default-profile>community</product.default-profile>\n                <apache.httpcomponents.fuse.version>4.5.2</apache.httpcomponents.fuse.version>\n                <apache.httpcomponents.httpcore.fuse.version>4.4.4</apache.httpcomponents.httpcore.fuse.version>\n                <ee.maven.groupId>org.wildfly</ee.maven.groupId>\n                <ee.maven.version>${wildfly.version}</ee.maven.version>\n                <product.filename.version>${project.version}</product.filename.version>\n            </properties>\n        </profile>\n\n        <profile>\n            <id>jdk9</id>\n            <activation>\n                <jdk>[9,)</jdk>\n            </activation>\n            <properties>\n                <surefire.system.args>\n                    --add-opens=java.base/java.lang=ALL-UNNAMED\n                </surefire.system.args>\n            </properties>\n        </profile>\n\n        <profile>\n            <id>quarkus</id>\n            <activation>\n                <jdk>[11,)</jdk>\n                <property>\n                    <name>!product</name>\n                </property>\n            </activation>\n            <modules>\n                <module>quarkus</module>\n            </modules>\n        </profile>\n\n        <profile>\n            <id>product</id>\n            <activation>\n                <property>\n                    <name>product</name>\n                </property>\n            </activation>\n            <properties>\n                <product.name.full>Red Hat Single Sign-On</product.name.full>\n                <product.name>rh-sso</product.name>\n                <product.slot>rh-sso</product.slot>\n                <product.wildfly.console.slot>eap</product.wildfly.console.slot>\n                <product.name-html>\u003Cstrong\u003ERed Hat\u003C\u002Fstrong\u003E\u003Csup\u003E\u00AE\u003C\u002Fsup\u003E Single Sign On</product.name-html>\n                <product.version>${product.rhsso.version}</product.version>\n                <apache.httpcomponents.fuse.version>4.5.2.redhat-2</apache.httpcomponents.fuse.version>\n                <apache.httpcomponents.httpcore.fuse.version>4.4.4.redhat-2</apache.httpcomponents.httpcore.fuse.version>\n                <product.default-profile>product</product.default-profile>\n                <ee.maven.groupId>org.jboss.eap</ee.maven.groupId>\n                <ee.maven.version>${eap.version}</ee.maven.version>\n                <!-- Properties that drive the names of various directories produced by and used in the build -->\n                <server.output.dir.prefix>${product.name}</server.output.dir.prefix>\n                <!-- Version suffix that is appended to directories. Default is the maven GAV version but this can be edited to use a short form version -->\n                <server.output.dir.version>${product.filename.version}</server.output.dir.version>\n            </properties>\n            <build>\n                <plugins>\n                    <plugin>\n                        <groupId>org.codehaus.mojo</groupId>\n                        <artifactId>build-helper-maven-plugin</artifactId>\n                        <version>1.7</version>\n                        <executions>\n                            <execution>\n                                <id>set-product-filename-version</id>\n                                <goals>\n                                    <goal>regex-property</goal>\n                                </goals>\n                                <phase>initialize</phase>\n                                <configuration>\n                                    <name>product.filename.version</name>\n                                    <value>${product.rhsso.version}</value>\n                                    <regex>^(\d+(\.\d+)?).*?$</regex>\n                                    <replacement>$1</replacement>\n                                    <failIfNoMatch>true</failIfNoMatch>\n                                </configuration>\n                            </execution>\n                        </executions>\n                    </plugin>\n                </plugins>\n            </build>\n        </profile>\n\n        <profile>\n            <id>testsuite</id>\n            <activation>\n                <property>\n                    <name>!skipTestsuite</name>\n                </property>\n            </activation>\n            <modules>\n                <module>testsuite</module>\n            </modules>\n        </profile>\n\n        <profile>\n            <id>examples</id>\n            <activation>\n                <property>\n                    <name>!skipExamples</name>\n                </property>\n            </activation>\n            <modules>\n                <module>examples</module>\n            </modules>\n        </profile>\n\n        <profile>\n            <id>distribution</id>\n            <modules>\n                <module>distribution</module>\n            </modules>\n        </profile>\n\n        <profile>\n            <id>jboss-release</id>\n            <modules>\n                <module>distribution</module>\n            </modules>\n        </profile>\n\n        <profile>\n            <id>operator</id>\n            <activation>\n                <jdk>[11,)</jdk>\n                <property>\n                    <name>operator</name>\n                </property>\n            </activation>\n            <modules>\n                <module>operator</module>\n            </modules>\n        </profile>\n\n        <profile>\n            <id>doclint-java8-disable</id>\n            <activation>\n                <jdk>[1.8,)</jdk>\n            </activation>\n\n            <build>\n                <plugins>\n                    <plugin>\n                        <groupId>org.apache.maven.plugins</groupId>\n                        <artifactId>maven-javadoc-plugin</artifactId>\n                        <configuration>\n                            <additionalparam>-Xdoclint:none</additionalparam>\n                            <failOnError>false</failOnError>\n                            <excludePackageNames>cx.*:org.freedesktop*:org.jvnet*</excludePackageNames>\n                        </configuration>\n                    </plugin>\n                </plugins>\n            </build>\n        </profile>\n\n        <profile>\n            <id>nexus-staging</id>\n            <build>\n                <plugins>\n                    <plugin>\n                        <groupId>org.sonatype.plugins</groupId>\n                        <artifactId>nexus-staging-maven-plugin</artifactId>\n                    </plugin>\n                </plugins>\n            </build>\n        </profile>\n\n        <profile>\n            <id>gpg</id>\n            <build>\n                <plugins>\n                    <plugin>\n                        <groupId>org.apache.maven.plugins</groupId>\n                        <artifactId>maven-gpg-plugin</artifactId>\n                        <version>3.0.1</version>\n                        <executions>\n                            <execution>\n                                <id>sign-artifacts</id>\n                                <phase>verify</phase>\n                                <goals>\n                                    <goal>sign</goal>\n                                </goals>\n                                <configuration>\n                                    <gpgArguments>\n                                        <arg>--batch</arg>\n                                        <arg>--pinentry-mode</arg>\n                                        <arg>loopback</arg>\n                                    </gpgArguments>\n                                </configuration>\n                            </execution>\n                        </executions>\n                        <configuration>\n                        </configuration>\n                    </plugin>\n                </plugins>\n            </build>\n        </profile>\n\n    </profiles>\n</project>\n",
    expect: {file: 'pom.xml', purls: [          {purl: "pkg:maven/org.keycloak/keycloak-dependencies-admin-ui-wrapper?type=pom", requirement: "999-SNAPSHOT", scope: null},          {purl: "pkg:maven/org.jboss/jboss-dmr", requirement: "1.5.1.Final", scope: null},          {purl: "pkg:maven/com.sun.istack/istack-commons-runtime", requirement: "3.0.10", scope: null},          {purl: "pkg:maven/org.wildfly.common/wildfly-common", requirement: "1.6.0.Final", scope: null},          {purl: "pkg:maven/org.keycloak/keycloak-testsuite-utils", requirement: "999-SNAPSHOT", scope: null},          {purl: "pkg:maven/org.keycloak/keycloak-testsuite-tools", requirement: "999-SNAPSHOT", scope: null},          {purl: "pkg:maven/org.keycloak/keycloak-testsuite-tools?classifier=classes", requirement: "999-SNAPSHOT", scope: null},          {purl: "pkg:maven/org.eclipse.microprofile.metrics/microprofile-metrics-api", requirement: "2.3", scope: null},          {purl: "pkg:maven/org.keycloak/keycloak-server-galleon-pack?type=zip", requirement: "999-SNAPSHOT", scope: null},          {purl: "pkg:maven/org.keycloak/keycloak-server-galleon-pack?type=pom", requirement: "999-SNAPSHOT", scope: null},          {purl: "pkg:maven/org.wildfly.galleon-plugins/wildfly-galleon-plugins", requirement: "5.2.7.Final", scope: null},          {purl: "pkg:maven/org.wildfly.galleon-plugins/wildfly-config-gen", requirement: "5.2.7.Final", scope: null},          {purl: "pkg:maven/org.wildfly.galleon-plugins/transformer", requirement: "5.2.7.Final", scope: null},          {purl: "pkg:maven/org.wildfly.core/wildfly-embedded", requirement: "18.1.0.Final", scope: null}        ]},
    parser: pomParser,
  },
  {
    test_name: "pom.xml example 2",
    source: "",
    note: "",
    file_name: "pom.xml",
    file_content: "<?xml version='1.0' encoding='UTF-8'?>\n<!--\n~ Copyright 2016 Red Hat, Inc. and/or its affiliates\n~ and other contributors as indicated by the @author tags.\n~\n~ Licensed under the Apache License, Version 2.0 (the \"License\");\n~ you may not use this file except in compliance with the License.\n~ You may obtain a copy of the License at\n~\n~ http://www.apache.org/licenses/LICENSE-2.0\n~\n~ Unless required by applicable law or agreed to in writing, software\n~ distributed under the License is distributed on an \"AS IS\" BASIS,\n~ WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n~ See the License for the specific language governing permissions and\n~ limitations under the License.\n\n-->\n<project xmlns=\"http://maven.apache.org/POM/4.0.0\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xsi:schemaLocation=\"http://maven.apache.org/POM/4.0.0 http://maven.apache.org/maven-v4_0_0.xsd\">\n    <modelVersion>4.0.0</modelVersion>\n\n    <parent>\n        <groupId>org.jboss</groupId>\n        <artifactId>jboss-parent</artifactId>\n        <version>37</version>\n    </parent>\n\n    <name>Keycloak</name>\n    <description>\n        Keycloak SSO\n    </description>\n    <groupId>org.keycloak</groupId>\n    <artifactId>keycloak-parent</artifactId>\n    <version>999-SNAPSHOT</version>\n    <packaging>pom</packaging>\n\n    <properties>\n        <jboss.repo.nexusUrl>https://s01.oss.sonatype.org/</jboss.repo.nexusUrl>\n        <jboss.releases.repo.id>jboss-releases-repository</jboss.releases.repo.id>\n        <jboss.releases.repo.url>https://s01.oss.sonatype.org/service/local/staging/deploy/maven2/</jboss.releases.repo.url>\n        <jboss.snapshots.repo.id>jboss-snapshots-repository</jboss.snapshots.repo.id>\n        <jboss.snapshots.repo.url>https://s01.oss.sonatype.org/content/repositories/snapshots/</jboss.snapshots.repo.url>\n\n        <quarkus.version>2.7.5.Final</quarkus.version>\n\n        <!--\n        Performing a Wildfly upgrade? Run the:\n\n             \"./misc/scripts/upgrade-wildfly/upgrade-keycloak-to-wildfly-tag.py\"\n\n        script with the corresponding Wildfly tag, e.g. '20.0.0.Final' to get necessary Keycloak bits\n        updated automatically based on corresponding artifact versions used in Wildfly and Wildfly Core\n\n        IMPORTANT: If you add new dependency name / version property below, be sure to update the\n        \"./misc/scripts/upgrade-wildfly/upgrade-keycloak-to-wildfly-tag.py\" script too to ensure\n        the script continues to work\n        -->\n\n        <product.rhsso.version>7.5.0.GA</product.rhsso.version>\n\n        <product.build-time>${timestamp}</product.build-time>\n        <wildfly.version>26.1.0.Final</wildfly.version>\n        <wildfly.build-tools.version>1.2.13.Final</wildfly.build-tools.version>\n        <eap.version>7.4.0.GA-redhat-00005</eap.version>\n        <wildfly.core.version>18.1.0.Final</wildfly.core.version>\n\n        <jboss.as.version>7.2.0.Final</jboss.as.version>\n        <jboss.as.subsystem.test.version>7.5.22.Final-redhat-1</jboss.as.subsystem.test.version>\n\n        <!-- Versions used mostly for Undertow server, aligned with WildFly -->\n        <jboss.aesh.version>0.66.19</jboss.aesh.version>\n        <aesh.version>2.4</aesh.version>\n        <apache.httpcomponents.version>4.5.13</apache.httpcomponents.version>\n        <apache.httpcomponents.httpcore.version>4.4.14</apache.httpcomponents.httpcore.version>\n        <apache.mime4j.version>0.6</apache.mime4j.version>\n        <jboss.dmr.version>1.5.1.Final</jboss.dmr.version>\n        <bouncycastle.version>1.68</bouncycastle.version>\n        <cxf.version>3.3.10</cxf.version>\n        <cxf.jetty.version>3.3.10</cxf.jetty.version>\n        <cxf.jaxrs.version>3.3.10</cxf.jaxrs.version>\n        <cxf.undertow.version>3.3.10</cxf.undertow.version>\n        <dom4j.version>2.1.3</dom4j.version>\n        <h2.version>1.4.197</h2.version>\n        <jakarta.persistence.version>2.2.3</jakarta.persistence.version>\n        <hibernate.core.version>5.3.24.Final</hibernate.core.version>\n        <hibernate.c3p0.version>5.3.24.Final</hibernate.c3p0.version>\n        <infinispan.version>12.1.7.Final</infinispan.version>\n        <infinispan.protostream.processor.version>4.4.1.Final</infinispan.protostream.processor.version>\n        <javax.annotation-api.version>1.3.2</javax.annotation-api.version>\n        <jackson.version>2.12.1</jackson.version>\n        <jackson.databind.version>2.12.6.1</jackson.databind.version>\n        <jackson.annotations.version>${jackson.databind.version}</jackson.annotations.version>\n        <jakarta.mail.version>1.6.5</jakarta.mail.version>\n        <jboss-jaxrs-api_2.1_spec>2.0.1.Final</jboss-jaxrs-api_2.1_spec>\n        <jboss.logging.version>3.4.1.Final</jboss.logging.version>\n        <jboss.logging.tools.version>2.2.1.Final</jboss.logging.tools.version>\n        <jboss.marshalling.version>2.0.11.Final</jboss.marshalling.version>\n        <jboss-transaction-api_1.3_spec>2.0.0.Final</jboss-transaction-api_1.3_spec>\n        <jboss.spec.javax.xml.bind.jboss-jaxb-api_2.3_spec.version>2.0.1.Final</jboss.spec.javax.xml.bind.jboss-jaxb-api_2.3_spec.version>\n        <jboss.spec.javax.servlet.jsp.jboss-jsp-api_2.3_spec.version>2.0.0.Final</jboss.spec.javax.servlet.jsp.jboss-jsp-api_2.3_spec.version>\n        <log4j.version>1.2.17</log4j.version>\n        <resteasy.version>3.15.1.Final</resteasy.version>\n        <resteasy.undertow.version>${resteasy.version}</resteasy.undertow.version>\n        <owasp.html.sanitizer.version>20211018.2</owasp.html.sanitizer.version>\n        <slf4j-api.version>1.7.30</slf4j-api.version>\n        <slf4j.version>1.7.30</slf4j.version>\n        <sun.istack.version>3.0.10</sun.istack.version>\n        <sun.xml.bind.version>2.3.3-b02</sun.xml.bind.version>\n        <javax.xml.bind.jaxb.version>2.4.0-b180830.0359</javax.xml.bind.jaxb.version>\n        <sun.xml.ws.version>2.3.1</sun.xml.ws.version>\n        <sun.activation.version>1.2.2</sun.activation.version>\n        <org.glassfish.jaxb.xsom.version>2.3.3-b02</org.glassfish.jaxb.xsom.version>\n        <undertow.version>2.2.5.Final</undertow.version>\n        <elytron.version>1.18.3.Final</elytron.version>\n        <elytron.undertow-server.version>1.9.0.Final</elytron.undertow-server.version>\n        <jetty94.version>9.4.40.v20210413</jetty94.version>\n        <woodstox.version>6.0.3</woodstox.version>\n        <xmlsec.version>2.2.3</xmlsec.version>\n        <glassfish.json.version>1.1.6</glassfish.json.version>\n        <wildfly.common.version>1.6.0.Final</wildfly.common.version>\n        <ua-parser.version>1.5.2</ua-parser.version>\n        <picketbox.version>5.0.3.Final</picketbox.version>\n        <google.guava.version>30.1-jre</google.guava.version>\n\n        <!-- Openshift -->\n        <version.com.openshift.openshift-restclient-java>8.0.0.Final</version.com.openshift.openshift-restclient-java>\n\n        <!-- Others -->\n        <commons-lang.version>2.6</commons-lang.version>\n        <commons-lang3.version>3.11</commons-lang3.version>\n        <commons-io.version>2.7</commons-io.version>\n        <apacheds.version>2.0.0.AM26</apacheds.version>\n        <apacheds.codec.version>2.0.0</apacheds.codec.version>\n        <google.zxing.version>3.4.0</google.zxing.version>\n        <freemarker.version>2.3.31</freemarker.version>\n\n        <jetty9.version>${jetty94.version}</jetty9.version>\n        <liquibase.version>4.8.0</liquibase.version>\n        <osgi.version>4.2.0</osgi.version>\n        <pax.web.version>7.1.0</pax.web.version>\n        <servlet.api.30.version>1.0.2.Final</servlet.api.30.version>\n        <servlet.api.40.version>2.0.0.Final</servlet.api.40.version>\n        <twitter4j.version>4.0.7</twitter4j.version>\n        <jna.version>4.1.0</jna.version>\n\n        <!-- Databases -->\n        <mysql.version>8.0.23</mysql.version>\n        <mysql.driver.version>8.0.23</mysql.driver.version>\n        <postgresql.version>13.2</postgresql.version>\n        <postgresql.driver.version>42.3.3</postgresql.driver.version>\n        <mariadb.version>10.3.27</mariadb.version>\n        <mariadb.driver.version>2.7.2</mariadb.driver.version>\n        <mssql.version>2019-CU10-ubuntu-20.04</mssql.version>\n        <mssql.driver.version>9.2.0.jre8</mssql.driver.version>\n\n        <!-- Test -->\n        <greenmail.version>1.3.1b</greenmail.version>\n        <hamcrest.version>2.2</hamcrest.version>\n        <jmeter.version>2.10</jmeter.version>\n        <junit.version>4.13.2</junit.version>\n        <picketlink.version>2.7.0.Final</picketlink.version>\n        <selenium.version>2.35.0</selenium.version>\n        <xml-apis.version>1.4.01</xml-apis.version>\n        <subethasmtp.version>3.1.7</subethasmtp.version>\n        <awaitility.version>4.1.1</awaitility.version>\n        <assertj-core.version>3.22.0</assertj-core.version>\n        <!-- KEYCLOAK-17585 Prevent microprofile-metrics-api upgrades from version \"2.3\" due to:\n             https://issues.redhat.com/browse/KEYCLOAK-17585?focusedCommentId=16002705&page=com.atlassian.jira.plugin.system.issuetabpanels%3Acomment-tabpanel#comment-16002705\n        -->\n        <microprofile-metrics-api.version>2.3</microprofile-metrics-api.version>\n\n        <!-- Maven Plugins -->\n        <replacer.plugin.version>1.3.5</replacer.plugin.version>\n        <jboss.as.plugin.version>7.5.Final</jboss.as.plugin.version>\n        <jmeter.plugin.version>1.9.0</jmeter.plugin.version>\n        <jmeter.analysis.plugin.version>1.0.4</jmeter.analysis.plugin.version>\n        <minify.plugin.version>1.7.6</minify.plugin.version>\n        <osgi.bundle.plugin.version>2.3.7</osgi.bundle.plugin.version>\n        <wildfly.plugin.version>2.0.1.Final</wildfly.plugin.version>\n        <nexus.staging.plugin.version>1.6.5</nexus.staging.plugin.version>\n        <frontend.plugin.version>1.12.0</frontend.plugin.version>\n        <docker.maven.plugin.version>0.28.0</docker.maven.plugin.version>\n        <verifier.plugin.version>1.1</verifier.plugin.version>\n\n        <!-- Surefire Settings -->\n        <surefire.memory.Xms>512m</surefire.memory.Xms>\n        <surefire.memory.Xmx>2048m</surefire.memory.Xmx>\n        <surefire.memory.metaspace>96m</surefire.memory.metaspace>\n        <surefire.memory.metaspace.max>512m</surefire.memory.metaspace.max>\n        <surefire.memory.settings>-Xms${surefire.memory.Xms} -Xmx${surefire.memory.Xmx} -XX:MetaspaceSize=${surefire.memory.metaspace} -XX:MaxMetaspaceSize=${surefire.memory.metaspace.max}</surefire.memory.settings>\n        <surefire.system.args></surefire.system.args>\n\n        <!-- Tomcat versions -->\n        <tomcat8.version>8.5.38</tomcat8.version>\n        <tomcat9.version>9.0.16</tomcat9.version>\n\n        <!-- Spring Boot versions, used for tests -->\n        <spring-boot24.version>2.4.13</spring-boot24.version>\n        <spring-boot26.version>2.6.1</spring-boot26.version>\n\n        <!-- webauthn support -->\n        <webauthn4j.version>0.12.0.RELEASE</webauthn4j.version>\n        <org.apache.kerby.kerby-asn1.version>2.0.0</org.apache.kerby.kerby-asn1.version>\n\n        <!-- WildFly Galleon Build related properties -->\n        <org.wildfly.galleon-plugins.version>5.2.7.Final</org.wildfly.galleon-plugins.version>\n        <org.jboss.galleon.version>4.2.8.Final</org.jboss.galleon.version>\n\n        <!-- Galleon -->\n        <galleon.fork.embedded>true</galleon.fork.embedded>\n        <galleon.log.time>true</galleon.log.time>\n        <galleon.offline>true</galleon.offline>\n\n        <!-- Properties that drive the names of various directories produced by and used in the build -->\n        <server.output.dir.prefix>keycloak</server.output.dir.prefix>\n        <!-- Version suffix that is appended to directories. Default is the maven GAV version but this can be edited to use a short form version -->\n        <server.output.dir.version>${project.version}</server.output.dir.version>\n\n        <!-- Frontend -->\n        <node.version>v16.13.2</node.version>\n    </properties>\n\n    <url>http://keycloak.org</url>\n\n    <licenses>\n        <license>\n            <name>Apache License, Version 2.0</name>\n            <url>https://www.apache.org/licenses/LICENSE-2.0</url>\n            <distribution>repo</distribution>\n        </license>\n    </licenses>\n\n    <scm>\n        <connection>scm:git:git://github.com/keycloak/keycloak.git</connection>\n        <developerConnection>scm:git:git@github.com:keycloak/keycloak.git</developerConnection>\n        <url>https://github.com/keycloak/keycloak/tree/master/</url>\n    </scm>\n\n    <distributionManagement>\n        <repository>\n            <id>${jboss.releases.repo.id}</id>\n            <name>JBoss Releases Repository</name>\n            <url>${jboss.releases.repo.url}</url>\n        </repository>\n    </distributionManagement>\n\n    <issueManagement>\n        <system>JIRA</system>\n        <url>https://github.com/keycloak/keycloak/issues</url>\n    </issueManagement>\n\n    <developers>\n        <developer>\n            <id>keycloak</id>\n            <name>Keycloak Team</name>\n        </developer>\n    </developers>\n\n    <contributors></contributors>\n\n    <modules>\n        <module>boms</module>\n        <module>common</module>\n        <module>core</module>\n        <module>dependencies</module>\n        <module>docs</module>\n        <module>server-spi</module>\n        <module>server-spi-private</module>\n        <module>saml-core-api</module>\n        <module>saml-core</module>\n        <module>federation</module>\n        <module>services</module>\n        <module>themes</module>\n        <module>model</module>\n        <module>util</module>\n        <module>wildfly</module>\n        <module>integration</module>\n        <module>adapters</module>\n        <module>authz</module>\n        <module>misc</module>\n    </modules>\n\n    <dependencyManagement>\n\n        <dependencies>\n\n            <dependency>\n                <groupId>javax.xml.bind</groupId>\n                <artifactId>jaxb-api</artifactId>\n                <version>${javax.xml.bind.jaxb.version}</version>\n            </dependency>\n \n        </dependencies>\n    </dependencyManagement>\n\n    <build>\n        <pluginManagement>\n            <plugins>\n                <plugin>\n                    <groupId>org.sonatype.plugins</groupId>\n                    <artifactId>nexus-staging-maven-plugin</artifactId>\n                    <version>${nexus.staging.plugin.version}</version>\n                    <extensions>true</extensions>\n                    <configuration>\n                        <serverId>${jboss.releases.repo.id}</serverId>\n                        <nexusUrl>${jboss.repo.nexusUrl}</nexusUrl>\n                    </configuration>\n                </plugin>\n                <plugin>\n                    <groupId>org.apache.maven.plugins</groupId>\n                    <artifactId>maven-assembly-plugin</artifactId>\n                    <configuration>\n                        <tarLongFileMode>posix</tarLongFileMode>\n                    </configuration>\n                </plugin>\n                <plugin>\n                    <groupId>org.apache.maven.plugins</groupId>\n                    <artifactId>maven-dependency-plugin</artifactId>\n                    <version>3.1.2</version>\n                </plugin>\n                <plugin>\n                    <groupId>org.apache.maven.plugins</groupId>\n                    <artifactId>maven-release-plugin</artifactId>\n                    <version>2.5.2</version>\n                    <configuration>\n                        <autoVersionSubmodules>true</autoVersionSubmodules>\n                        <tagNameFormat>@{project.version}</tagNameFormat>\n                    </configuration>\n                </plugin>\n                <plugin>\n                    <groupId>org.apache.maven.plugins</groupId>\n                    <artifactId>maven-surefire-plugin</artifactId>\n                    <version>3.0.0-M5</version>\n                    <configuration>\n                        <forkNode implementation=\"org.apache.maven.plugin.surefire.extensions.SurefireForkNodeFactory\"/>\n                        <forkMode>once</forkMode>\n                        <argLine>-Djava.awt.headless=true ${surefire.memory.settings} ${surefire.system.args} -Duser.language=en -Duser.region=US</argLine>\n                        <runOrder>alphabetical</runOrder>\n                    </configuration>\n                </plugin>\n                <plugin>\n                    <groupId>org.apache.maven.plugins</groupId>\n                    <artifactId>maven-jar-plugin</artifactId>\n                </plugin>\n                <plugin>\n                    <groupId>com.google.code.maven-replacer-plugin</groupId>\n                    <artifactId>maven-replacer-plugin</artifactId>\n                    <version>${replacer.plugin.version}</version>\n                </plugin>\n                <plugin>\n                    <groupId>org.apache.maven.plugins</groupId>\n                    <artifactId>maven-install-plugin</artifactId>\n                    <configuration>\n                        <createChecksum>true</createChecksum>\n                    </configuration>\n                </plugin>\n                <plugin>\n                    <groupId>com.lazerycode.jmeter</groupId>\n                    <artifactId>jmeter-maven-plugin</artifactId>\n                    <version>${jmeter.plugin.version}</version>\n                </plugin>\n                <plugin>\n                    <groupId>com.lazerycode.jmeter</groupId>\n                    <artifactId>jmeter-analysis-maven-plugin</artifactId>\n                    <version>${jmeter.analysis.plugin.version}</version>\n                </plugin>\n                <plugin>\n                    <groupId>org.jboss.as.plugins</groupId>\n                    <artifactId>jboss-as-maven-plugin</artifactId>\n                    <version>${jboss.as.plugin.version}</version>\n                    <configuration>\n                        <skip>true</skip>\n                    </configuration>\n                </plugin>\n                <plugin>\n                    <groupId>org.wildfly.plugins</groupId>\n                    <artifactId>wildfly-maven-plugin</artifactId>\n                    <version>${wildfly.plugin.version}</version>\n                    <configuration>\n                        <skip>true</skip>\n                    </configuration>\n                </plugin>\n                <plugin>\n                    <groupId>org.jboss.galleon</groupId>\n                    <artifactId>galleon-maven-plugin</artifactId>\n                    <version>${org.jboss.galleon.version}</version>\n                </plugin>\n                <plugin>\n                    <groupId>com.samaxes.maven</groupId>\n                    <artifactId>minify-maven-plugin</artifactId>\n                    <version>${minify.plugin.version}</version>\n                </plugin>\n                <plugin>\n                    <groupId>org.liquibase</groupId>\n                    <artifactId>liquibase-maven-plugin</artifactId>\n                    <version>${liquibase.version}</version>\n                </plugin>\n                <plugin>\n                    <groupId>org.wildfly.build</groupId>\n                    <artifactId>wildfly-server-provisioning-maven-plugin</artifactId>\n                    <version>${wildfly.build-tools.version}</version>\n                </plugin>\n                <plugin>\n                    <groupId>org.wildfly.galleon-plugins</groupId>\n                    <artifactId>wildfly-galleon-maven-plugin</artifactId>\n                    <version>${org.wildfly.galleon-plugins.version}</version>\n\n                </plugin>\n                <plugin>\n                    <groupId>org.apache.maven.plugins</groupId>\n                    <artifactId>maven-verifier-plugin</artifactId>\n                    <version>${verifier.plugin.version}</version>\n                    <executions>\n                        <execution>\n                            <id>main</id>\n                            <phase>verify</phase>\n                            <goals>\n                                <goal>verify</goal>\n                            </goals>\n                        </execution>\n                    </executions>\n                    <configuration>\n                        <verificationFile>target/verifier/verifications.xml</verificationFile>\n                    </configuration>\n                </plugin>\n                <plugin>\n                    <groupId>org.apache.felix</groupId>\n                    <artifactId>maven-bundle-plugin</artifactId>\n                    <version>${osgi.bundle.plugin.version}</version>\n                </plugin>\n                <plugin>\n                    <groupId>com.github.eirslett</groupId>\n                    <artifactId>frontend-maven-plugin</artifactId>\n                    <version>${frontend.plugin.version}</version>\n                </plugin>\n                <plugin>\n                    <groupId>org.keycloak</groupId>\n                    <artifactId>keycloak-distribution-licenses-maven-plugin</artifactId>\n                    <version>${project.version}</version>\n                    <executions>\n                        <execution>\n                            <id>process-licenses</id>\n                            <goals>\n                                <goal>process</goal>\n                            </goals>\n                            <phase>process-resources</phase>\n                        </execution>\n                    </executions>\n                </plugin>\n            </plugins>\n        </pluginManagement>\n    </build>\n\n    <profiles>\n        <profile>\n            <id>community</id>\n            <activation>\n                <property>\n                    <name>!product</name>\n                </property>\n            </activation>\n            <properties>\n                <product.name>Keycloak</product.name>\n                <product.name.full>Keycloak</product.name.full>\n                <product.slot>keycloak</product.slot>\n                <product.wildfly.console.slot>main</product.wildfly.console.slot>\n                <product.name-html>\u003Cdiv class=\"kc-logo-text\"\u003E\u003Cspan\u003EKeycloak\u003C\u002Fspan\u003E\u003C\u002Fdiv\u003E</product.name-html>\n                <product.version>${project.version}</product.version>\n                <product.default-profile>community</product.default-profile>\n                <apache.httpcomponents.fuse.version>4.5.2</apache.httpcomponents.fuse.version>\n                <apache.httpcomponents.httpcore.fuse.version>4.4.4</apache.httpcomponents.httpcore.fuse.version>\n                <ee.maven.groupId>org.wildfly</ee.maven.groupId>\n                <ee.maven.version>${wildfly.version}</ee.maven.version>\n                <product.filename.version>${project.version}</product.filename.version>\n            </properties>\n        </profile>\n\n        <profile>\n            <id>jdk9</id>\n            <activation>\n                <jdk>[9,)</jdk>\n            </activation>\n            <properties>\n                <surefire.system.args>\n                    --add-opens=java.base/java.lang=ALL-UNNAMED\n                </surefire.system.args>\n            </properties>\n        </profile>\n\n        <profile>\n            <id>quarkus</id>\n            <activation>\n                <jdk>[11,)</jdk>\n                <property>\n                    <name>!product</name>\n                </property>\n            </activation>\n            <modules>\n                <module>quarkus</module>\n            </modules>\n        </profile>\n\n        <profile>\n            <id>product</id>\n            <activation>\n                <property>\n                    <name>product</name>\n                </property>\n            </activation>\n            <properties>\n                <product.name.full>Red Hat Single Sign-On</product.name.full>\n                <product.name>rh-sso</product.name>\n                <product.slot>rh-sso</product.slot>\n                <product.wildfly.console.slot>eap</product.wildfly.console.slot>\n                <product.name-html>\u003Cstrong\u003ERed Hat\u003C\u002Fstrong\u003E\u003Csup\u003E\u00AE\u003C\u002Fsup\u003E Single Sign On</product.name-html>\n                <product.version>${product.rhsso.version}</product.version>\n                <apache.httpcomponents.fuse.version>4.5.2.redhat-2</apache.httpcomponents.fuse.version>\n                <apache.httpcomponents.httpcore.fuse.version>4.4.4.redhat-2</apache.httpcomponents.httpcore.fuse.version>\n                <product.default-profile>product</product.default-profile>\n                <ee.maven.groupId>org.jboss.eap</ee.maven.groupId>\n                <ee.maven.version>${eap.version}</ee.maven.version>\n                <!-- Properties that drive the names of various directories produced by and used in the build -->\n                <server.output.dir.prefix>${product.name}</server.output.dir.prefix>\n                <!-- Version suffix that is appended to directories. Default is the maven GAV version but this can be edited to use a short form version -->\n                <server.output.dir.version>${product.filename.version}</server.output.dir.version>\n            </properties>\n            <build>\n                <plugins>\n                    <plugin>\n                        <groupId>org.codehaus.mojo</groupId>\n                        <artifactId>build-helper-maven-plugin</artifactId>\n                        <version>1.7</version>\n                        <executions>\n                            <execution>\n                                <id>set-product-filename-version</id>\n                                <goals>\n                                    <goal>regex-property</goal>\n                                </goals>\n                                <phase>initialize</phase>\n                                <configuration>\n                                    <name>product.filename.version</name>\n                                    <value>${product.rhsso.version}</value>\n                                    <regex>^(\d+(\.\d+)?).*?$</regex>\n                                    <replacement>$1</replacement>\n                                    <failIfNoMatch>true</failIfNoMatch>\n                                </configuration>\n                            </execution>\n                        </executions>\n                    </plugin>\n                </plugins>\n            </build>\n        </profile>\n\n        <profile>\n            <id>testsuite</id>\n            <activation>\n                <property>\n                    <name>!skipTestsuite</name>\n                </property>\n            </activation>\n            <modules>\n                <module>testsuite</module>\n            </modules>\n        </profile>\n\n        <profile>\n            <id>examples</id>\n            <activation>\n                <property>\n                    <name>!skipExamples</name>\n                </property>\n            </activation>\n            <modules>\n                <module>examples</module>\n            </modules>\n        </profile>\n\n        <profile>\n            <id>distribution</id>\n            <modules>\n                <module>distribution</module>\n            </modules>\n        </profile>\n\n        <profile>\n            <id>jboss-release</id>\n            <modules>\n                <module>distribution</module>\n            </modules>\n        </profile>\n\n        <profile>\n            <id>operator</id>\n            <activation>\n                <jdk>[11,)</jdk>\n                <property>\n                    <name>operator</name>\n                </property>\n            </activation>\n            <modules>\n                <module>operator</module>\n            </modules>\n        </profile>\n\n        <profile>\n            <id>doclint-java8-disable</id>\n            <activation>\n                <jdk>[1.8,)</jdk>\n            </activation>\n\n            <build>\n                <plugins>\n                    <plugin>\n                        <groupId>org.apache.maven.plugins</groupId>\n                        <artifactId>maven-javadoc-plugin</artifactId>\n                        <configuration>\n                            <additionalparam>-Xdoclint:none</additionalparam>\n                            <failOnError>false</failOnError>\n                            <excludePackageNames>cx.*:org.freedesktop*:org.jvnet*</excludePackageNames>\n                        </configuration>\n                    </plugin>\n                </plugins>\n            </build>\n        </profile>\n\n        <profile>\n            <id>nexus-staging</id>\n            <build>\n                <plugins>\n                    <plugin>\n                        <groupId>org.sonatype.plugins</groupId>\n                        <artifactId>nexus-staging-maven-plugin</artifactId>\n                    </plugin>\n                </plugins>\n            </build>\n        </profile>\n\n        <profile>\n            <id>gpg</id>\n            <build>\n                <plugins>\n                    <plugin>\n                        <groupId>org.apache.maven.plugins</groupId>\n                        <artifactId>maven-gpg-plugin</artifactId>\n                        <version>3.0.1</version>\n                        <executions>\n                            <execution>\n                                <id>sign-artifacts</id>\n                                <phase>verify</phase>\n                                <goals>\n                                    <goal>sign</goal>\n                                </goals>\n                                <configuration>\n                                    <gpgArguments>\n                                        <arg>--batch</arg>\n                                        <arg>--pinentry-mode</arg>\n                                        <arg>loopback</arg>\n                                    </gpgArguments>\n                                </configuration>\n                            </execution>\n                        </executions>\n                        <configuration>\n                        </configuration>\n                    </plugin>\n                </plugins>\n            </build>\n        </profile>\n\n    </profiles>\n</project>\n",
    expect: {file: 'pom.xml', purls: [ {purl: "pkg:maven/javax.xml.bind/jaxb-api", requirement: "2.4.0-b180830.0359", scope: null}]},
    parser: pomParser,
  },
  /****************************************************************************/
  /*                 PYPROJECT.TOML DEPENDENCY TEST DATA                      */
  /****************************************************************************/
  {
    test_name: 'pyproject.toml example 1 ',
    source:
      'https://packaging.python.org/en/latest/guides/writing-pyproject-toml/#a-full-example',
    note: 'This is the official example published on the pyproject.toml specification website',
    file_name: 'pyproject.toml',
    file_content:
      '[build-system]\nrequires = ["hatchling"]\nbuild-backend = "hatchling.build"\n\n  [project]\nname = "spam-eggs"\nversion = "2020.0.0"\ndependencies = [\n  "httpx",\n  "gidgethub[httpx]>4.0.0",\n  "django>2.1; os_name != \'nt\'",\n  "django>2.0; os_name == \'nt\'",\n]\nrequires-python = ">=3.8"\nauthors = [\n  {name = "Pradyun Gedam", email = "pradyun@example.com"},\n  {name = "Tzu-Ping Chung", email = "tzu-ping@example.com"},\n  {name = "Another person"},\n  {email = "different.person@example.com"},\n]\nmaintainers = [\n  {name = "Brett Cannon", email = "brett@example.com"}\n]\ndescription = "Lovely Spam! Wonderful Spam!"\nreadme = "README.rst"\nlicense = {file = "LICENSE.txt"}\nkeywords = ["egg", "bacon", "sausage", "tomatoes", "Lobster Thermidor"]\nclassifiers = [\n  "Development Status :: 4 - Beta",\n  "Programming Language :: Python"\n]\n\n  [project.optional-dependencies]\ngui = ["PyQt5"]\ncli = [\n  "rich",\n  "click",\n]\n\n  [project.urls]\nHomepage = "https://example.com"\nDocumentation = "https://readthedocs.org"\nRepository = "https://github.com/me/spam.git"\n"Bug Tracker" = "https://github.com/me/spam/issues"\nChangelog = "https://github.com/me/spam/blob/master/CHANGELOG.md"\n\n  [project.scripts]\nspam-cli = "spam:main_cli"\n\n  [project.gui-scripts]\nspam-gui = "spam:main_gui"\n\n  [project.entry-points."spam.magical"]\ntomatoes = "spam:main_tomatoes"',
    expect: { file: 'pyproject.toml', purls: [{purl: "httpx"},{purl: "pkg:pypi/gidgethub", requirement:">4.0.0"}, {purl: "django", requirement:">2.1"}, {purl: "django", requirement: ">2.0"}] },
    parser: pyProjectToml,
  },
  {
    test_name: 'pyproject.toml example 2',
    source: 'https://martin-thoma.com/pyproject-toml/',
    note: '',
    file_name: 'pyproject.toml',
    file_content:
      '[project]\nname = "infer_pyproject"\nversion = "0.1.0"\ndescription = "Create a pyproject.toml file for an existing project."\nauthors = [\n  {name = "Martin Thoma", email="info@martin-thoma.de"},\n  {email = "info@example.com"}\n]\nlicense = {file = "LICENSE.txt"}\nreadme = "README.md"\nrequires-python = ">=3.6"\n\nkeywords = ["packaging", "dependency", "infer", "pyproject.toml"]\n\nclassifiers = [\n  "Topic :: Software Development"\n]\n\n# Requirements: This is done differently by poetry!\ndependencies = [\n  "Click>=7.0"\n]\n\n  [project.optional-dependencies]\ndev = [\n  "black>=18.3-alpha.0",\n]\n\n  [project.urls]\nhomepage = "https://github.com/MartinThoma/infer_pyproject"\ndocumentation = "https://github.com/MartinThoma/infer_pyproject"\nrepository = "https://github.com/MartinThoma/infer_pyproject"\n\n  [project.scripts]\npoetry = "infer_pyproject.cli:main"\n\n  [build-system]\nrequires = [\n  "setuptools >= 35.0.2",\n  "setuptools_scm >= 2.0.0, <3"\n]\nbuild-backend = "setuptools.build_meta"\n\n  [tool.black]\nline-length = 88\ntarget_version = [\'py36\']\ninclude = \'.pyi?$\'\nexclude = \'\'\'\n\n(\n  /(\n      .eggs         # exclude a few common directories in the\n| .git          # root of the project\n| .hg\n| .mypy_cache\n| .tox\n| .venv\n| _build\n| buck-out\n| build\n| dist\n)/\n| foo.py           # also separately exclude a file named foo.py in\n# the root of the project\n)\n\'\'\'',
    expect: { file: 'pyproject.toml', purls: [{purl: "pkg:pypi/Click", requirement: ">=7.0"}] },
    parser: pyProjectToml,
  },
  {
    test_name: 'pyproject.toml example 3',
    source:
      'https://gist.github.com/GhostofGoes/75051c4aeb215bc3cf48c10f5454b399',
    note: 'This file has a project table declared with dependency key but with no values, instead it only has a comment inside',
    file_name: 'pyproject.toml',
    file_content:
      '# This example pyproject.toml is for a basic pip+setuptools setup.\n# If you use a project management tool (like Poetry), then\n# those tools will have slightly different configurations or additions.\n\n# I highly recommend using a project management tool for your project.\n# Project management is a highly opinionated subject.\n# There are a lot of good, robust tools in this space now (as of 2023)\n# Two that I\'ve used and recommend are Poetry and PDM.\n# Poetry is more mature, PDM is recent, both work well.\n# - Poetry: https://python-poetry.org/\n  # - PDM: https://pdm.fming.dev/latest/\n\n  # Resources\n#\n# - https://packaging.python.org/en/latest/tutorials/packaging-projects/\n# - https://betterprogramming.pub/a-pyproject-toml-developers-cheat-sheet-5782801fb3ed\n#\n# Examples of pyproject.toml files from open-source projects:\n  # - https://github.com/carlosperate/awesome-pyproject\n# - https://github.com/SpikeInterface/spikeinterface/blob/master/pyproject.toml\n# - https://github.com/codespell-project/codespell/blob/master/pyproject.toml\n# - https://github.com/hynek/structlog/blob/main/pyproject.toml\n\n\n[build-system]\nbuild-backend = "setuptools.build_meta"\nrequires = ["setuptools>=61.0", "wheel>=0.37.1"]\n\n\n  [project]\n# https://packaging.python.org/en/latest/specifications/declaring-project-metadata/\n  name = "acme"\nversion = "0.0.1"\ndescription = "ACME tool"\nreadme = "README.md"\nrequires-python = ">=3.9,<4.0"\n# "LICENSE" is name of the license file, which must be in root of project folder\nlicense = {file = "LICENSE"}\nauthors = [\n  {name = "Joe Example", email = "example@example.com"},\n]\nkeywords = ["keyword", "are", "cool"]\n\n# https://pypi.org/classifiers/\n  # Add PyPI classifiers here\nclassifiers = [\n  "Development Status :: 5 - Production/Stable",\n  "Environment :: Console",\n  "License :: OSI Approved :: MIT License",\n  "Natural Language :: English",\n  "Operating System :: MacOS",\n  "Operating System :: Microsoft :: Windows",\n  "Operating System :: POSIX",\n  "Operating System :: POSIX :: Linux",\n  "Programming Language :: Python",\n  "Programming Language :: Python :: 3",\n  "Programming Language :: Python :: 3.9",\n  "Programming Language :: Python :: 3.10",\n  "Programming Language :: Python :: 3.11",\n  "Programming Language :: Python :: Implementation :: CPython",\n]\n\n# Required dependencies for install/usage of your package or application\n# If you don\'t have any dependencies, leave this section empty\n# Format for dependency strings: https://peps.python.org/pep-0508/\n  dependencies = [\n# ... put stuff here ...\n]\n\n[project.scripts]\n# Command line interface entrypoint scripts\nacme = "acme.__main__:main"\n\n  [project.urls]\n# Use PyPI-standard names here\n# Homepage\n# Documentation\n# Changelog\n# Issue Tracker\n# Source\n# Discord server\n"Homepage" = "<url>"\n"Documentation" = "<url>"\n\n# Development dependencies\n# pip install -e .[lint,test,exe]\n# pip install -e .[dev]\n  [project.optional-dependencies]\nlint = [\n# checks for spelling mistakes\n"codespell>=2.2.4",\n\n# ruff linter checks for issues and potential bugs\n"ruff",\n\n# checks for unused code\n"vulture",\n\n# required for codespell to parse pyproject.toml\n"tomli",\n\n# validation of pyproject.toml\n"validate-pyproject[all]",\n\n# automatic sorting of imports\n"isort",\n\n# automatic code formatting to follow a consistent style\n"black",\n]\n\ntest = [\n# Handles most of the testing work, including execution\n# Docs: https://docs.pytest.org/en/stable/contents.html\n  "pytest",\n\n# "Coverage" is how much of the code is actually run (it\'s "coverage")\n# Generates coverage reports from test suite runs\n"pytest-cov",\n  "tomli",\n\n# pytest wrapper around the "mock" library\n"pytest-mock",\n\n# Randomizes the order of test execution\n"pytest-randomly",\n\n# Required for comparing device data exports and a few other complex structures\n# Docs: https://zepworks.com/deepdiff/current/\n  "deepdiff",\n\n# Test parallelization, as well as remote execution (which we may do someday)\n"pytest-xdist[psutil]",\n\n# Detailed pytest results saved to a JSON file\n"pytest-json-report",\n\n# Better parsing of doctests\n"xdoctest",\n\n# Mocking of HTTP responses for the "requests" module\n"requests-mock",\n\n# Colors for doctest output\n"Pygments",\n]\n\nexe = [\n  "setuptools",\n  "wheel",\n  "build",\n  "tomli",\n  "pyinstaller",\n  "staticx;platform_system==\'Linux\'",\n]\n\ndev = [\n# https://hynek.me/articles/python-recursive-optional-dependencies/\n  "acme[lint,test,exe]",\n\n# Useful for building quick scripts for testing purposes\n# https://github.com/google/python-fire\n  "fire",\n\n# Code quality tools\n"mypy",\n\n# Improved exception traceback output\n# https://github.com/qix-/better-exceptions\n  "better_exceptions",\n\n# Analyzing dependencies\n# install graphviz to generate graphs\n"graphviz",\n  "pipdeptree",\n]\n\n\n[tool.setuptools]\n# https://setuptools.pypa.io/en/latest/userguide/pyproject_config.html\n  platforms = ["Linux", "Windows"]\ninclude-package-data = true\nzip-safe = true  # This just means it\'s safe to zip up the bdist\n\n# Non-code data that should be included in the package source code\n# https://setuptools.pypa.io/en/latest/userguide/datafiles.html\n  [tool.setuptools.package-data]\nacme = ["*.xml"]\n\n# Python modules and packages that are included in the\n# distribution package (and therefore become importable)\n[tool.setuptools.packages.find]\nexclude = ["tests", "tests.*", "examples"]\n\n\n\n# PDM example\n  [tool.pdm.scripts]\nisort = "isort acme"\nblack = "black acme"\nformat = {composite = ["isort", "black"]}\ncheck_isort = "isort --check acme tests"\ncheck_black = "black --check acme tests"\nvulture = "vulture --min-confidence 100 acme tests"\nruff = "ruff check acme tests"\nfix = "ruff check --fix acme tests"\ncodespell = "codespell --toml ./pyproject.toml"\nlint = {composite = ["vulture", "codespell", "ruff", "check_isort", "check_black"]}\n\n\n\n  [tool.codespell]\n# codespell supports pyproject.toml since version 2.2.2\n# NOTE: the "tomli" package must be installed for this to work\n# https://github.com/codespell-project/codespell#using-a-config-file\n  # NOTE: ignore words for codespell must be lowercase\ncheck-filenames = ""\nignore-words-list = "word,another,something"\nskip = "htmlcov,.doctrees,*.pyc,*.class,*.ico,*.out,*.PNG,*.inv,*.png,*.jpg,*.dot"\n\n\n  [tool.black]\nline-length = 88\n# If you need to exclude directories from being reformatted by black\n# force-exclude = \'\'\'\n# (\n#     somedirname\n#     | dirname\n#     | filename.py\n# )\n# \'\'\'\n\n\n  [tool.isort]\nprofile = "black"\nknown_first_party = ["acme"]\n# If you need to exclude files from having their imports sorted\nextend_skip_glob  = [\n  "acme/somefile.py",\n  "acme/somedir/*",\n]\n\n\n# https://beta.ruff.rs/docs\n  [tool.ruff]\nline-length = 99\nshow-source = true\n\n# Rules: https://beta.ruff.rs/docs/rules\n  # If you violate a rule, lookup the rule on the Rules page in ruff docs.\n# Many rules have links you can click with a explanation of the rule and how to fix it.\n# If there isn\'t a link, go to the project the rule was source from (e.g. flake8-bugbear)\n# and review it\'s docs for the corresponding rule.\n# If you\'re still confused, ask a fellow developer for assistance.\n# You can also run "ruff rule <rule>" to explain a rule on the command line, without a browser or internet access.\n  select = [\n  "E",    # pycodestyle\n"F",    # Pyflakes\n"W",    # Warning\n"B",    # flake8-bugbear\n"A",    # flake8-builtins\n"C4",   # flake8-comprehensions\n"T10",  # flake8-debugger\n"EXE",  # flake8-executable,\n  "ISC",  # flake8-implicit-str-concat\n"G",    # flake8-logging-format\n"PIE",  # flake8-pie\n"T20",  # flake8-print\n"PT",   # flake8-pytest-style\n"RSE",  # flake8-raise\n"RET",  # flake8-return\n"TID",  # flake8-tidy-imports\n"ARG",  # flake8-unused-arguments\n"PGH",  # pygrep-hooks\n"PLC",  # Pylint Convention\n"PLE",  # Pylint Errors\n"PLW",  # Pylint Warnings\n"RUF",  # Ruff-specific rules\n\n# ** Things to potentially enable in the future **\n# DTZ requires all usage of datetime module to have timezone-aware\n# objects (so have a tz argument or be explicitly UTC).\n# "DTZ",  # flake8-datetimez\n# "PTH",  # flake8-use-pathlib\n# "SIM",  # flake8-simplify\n]\n\n# Files to exclude from linting\nextend-exclude = [\n  "*.pyc",\n  "__pycache__",\n]\n\n# Linting error codes to ignore\nignore = [\n  "F403",    # unable to detect undefined names from star imports\n"F405",    # undefined locals from star imports\n"W605",    # invalid escape sequence\n"A003",    # shadowing python builtins\n"RET505",  # unnecessary \'else\' after \'return\' statement\n"RET504",  # Unnecessary variable assignment before return statement\n"RET507",  # Unnecessary {branch} after continue statement\n"PT011",   # pytest-raises-too-broad\n"PT012",   # pytest.raises() block should contain a single simple statement\n"PLW0603", # Using the global statement to update is discouraged\n"PLW2901", # for loop variable overwritten by assignment target\n"G004",    # Logging statement uses f-string\n"PIE790",  # no-unnecessary-pass\n"PIE810",  # multiple-starts-ends-with\n  "PGH003",  # Use specific rule codes when ignoring type issues\n"PLC1901", # compare-to-empty-string\n]\n\n# Linting error codes to ignore on a per-file basis\n  [tool.ruff.per-file-ignores]\n"__init__.py" = ["F401", "E501"]\n"acme/somefile.py" = ["E402", "E501"]\n"acme/somedir/*" = ["E501"]\n\n\n# Configuration for mypy\n  # https://mypy.readthedocs.io/en/stable/config_file.html#using-a-pyproject-toml-file\n  [tool.mypy]\npython_version = "3.9"\nfollow_imports = "skip"\nignore_missing_imports = true\nfiles = "acme"  # directory mypy should analyze\n# Directories to exclude from mypy\'s analysis\nexclude = [\n  "acme/somedir",\n  "acme/somefile\\.py",\n  "dirname",\n]\n\n\n# Configuration for pytest\n  # https://docs.pytest.org/en/latest/reference/customize.html#pyproject-toml\n  [tool.pytest.ini_options]\ntestpaths = "tests"  # directory containing your tests\nnorecursedirs = [\n  ".vscode",\n  "__pycache__"\n]\n# Warnings that should be ignored\nfilterwarnings = [\n  "ignore::DeprecationWarning"\n]\n# custom markers that can be used using pytest.mark\nmarkers = [\n  "slow: lower-importance tests that take an excessive amount of time",\n]\n\n\n# Configuration for coverage.py\n                      [tool.coverage.run]\n  # files or directories to exclude from coverage calculations\nomit = [\n  \'acme/somedir/*\',\n  \'acme/somefile.py\',\n]\n\n\n# Configuration for vulture\n                      [tool.vulture]\n  # Files or directories to exclude from vulture\n# The syntax is a little funky\nexclude = [\n  "somedir",\n  "*somefile.py",\n]',
    expect: { file: 'pyproject.toml', purls: [] },
    parser: pyProjectToml,
  },
  {
    test_name: 'pyproject.toml example 4',
    source:
      'https://setuptools.pypa.io/en/latest/userguide/pyproject_config.html',
    note: 'Uses a setuptools as buildtool',
    file_name: 'pyproject.toml',
    file_content:
      '[build-system]\nrequires = ["setuptools", "setuptools-scm"]\nbuild-backend = "setuptools.build_meta"\n\n[project]\nname = "my_package"\nauthors = [\n    {name = "Josiah Carberry", email = "josiah_carberry@brown.edu"},\n]\ndescription = "My package description"\nreadme = "README.rst"\nrequires-python = ">=3.7"\nkeywords = ["one", "two"]\nlicense = {text = "BSD-3-Clause"}\nclassifiers = [\n    "Framework :: Django",\n    "Programming Language :: Python :: 3",\n]\ndependencies = [\n    "requests",\n    \'importlib-metadata; python_version<"3.8"\',\n]\ndynamic = ["version"]\n\n[project.optional-dependencies]\npdf = ["ReportLab>=1.2", "RXP"]\nrest = ["docutils>=0.3", "pack ==1.1, ==1.3"]\n\n[project.scripts]\nmy-script = "my_package.module:function"\n\n# ... other project metadata fields as listed in:\n#     https://packaging.python.org/en/latest/guides/writing-pyproject-toml/\n',
    expect: { file: 'pyproject.toml', purls: [{purl: "pkg:pypi/requests"}, {purl: "pkg:pypi/importlib-metadata"}] },
    parser: pyProjectToml,
  },
  {
    test_name: 'pyproject.toml example 5',
    source: 'local',
    note: 'This is a empty file',
    file_name: 'pyproject.toml',
    file_content: '',
    expect: null,
    parser: pyProjectToml,
  },
];

describe('Testing all parsers', () => {

  ParserSpec.forEach(async (ds, i) => {
    it(`Test name ${ds.test_name}`, async () => {
      const d = await ds.parser(ds.file_content, ds.file_name);
      const dsp = ds.expect.purls.sort();
      const dp = d.purls.sort();

      for (let i = Math.min(dsp.length, dp.length)-1; i >= 0; i--) {
        expect(dp[i]).to.eql(dsp[i]);
      }

      expect(ds.expect.file).to.equal(d.file);
      expect(dsp.length).to.equal(dp.length);
    })

  })

});
